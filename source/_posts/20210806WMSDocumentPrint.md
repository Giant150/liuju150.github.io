---
layout: post
title: 'WMS中单据打印功能'
subtitle: '一步步了解单据打印功能是怎么实现的'
header-img: "img/bg1.jpg"
tags:
  - WMS
date: 2021-08-06 15:10:05
---

## 获取打印数据

因为我们要打印的话，我们要知道要打印哪些内容。
我们要把打印的内容组装成对应的数据
所以我们一般写一个获取打印数据的接口
WMS的Business层，只管处理数据，不处理打印模板
所有获取打印数据的接口返回值永远是PrintModel
![单据打印](1.png)
![单据打印](2.png)

PrintModel里有两个属性
![单据打印](3.png)

一般打印来说，都是单头与明细数据
Main就是单头要打印的数据
明细数据是DataSet可以有多个明细与子明细组成
根据现实情况来组成明细Regions数据

## 定义模板

我们在Api的Template文件夹里创建Word文件来做打印模板
模板内容与PrintModel实体里面对应的数据项一至
![单据打印](4.png)
![单据打印](5.png)
>单头Main的数据可以直接在Word里插入域
>明细数据用"TableStart:表名"开始，用"TableEnd:表名"结束

## 公开打印接口

我们创建一个Api的Action对外接口。
使用PrintHelper方法来生成打印文件PDF
![单据打印](6.png)
>第二个参数为模板名称
>第三个参数为获取的打印数据

## 前端实现

1.前端Api引用打印接口
![单据打印](7.png)

2.在要打印的页面上引用打印组件
![单据打印](8.png)

3.前面打印按钮方法
![单据打印](9.png)

4.点击打印后的效果
![单据打印](10.png)
